<p-toast />

@if (isLoading) {
  <div class="loading-overlay">
    <app-loader [isLoading]="isLoading"></app-loader>
  </div>
}

<form #productForm="ngForm" (ngSubmit)="onClickCreate(productForm)" class="product-form">
  <h2 class="form-title">Create New Product</h2>

  <div class="form-group">
    <label for="name">Product Name *</label>
    <input
      type="text"
      id="name"
      name="name"
      [(ngModel)]="productData.name"
      required
      class="form-control"
      placeholder="Enter product name"
      #fName="ngModel"
    />
    @if (fName.touched && fName.invalid) {
      <small class="control-error">* Product Name is a Required Field</small>
    }
  </div>

  <!-- Category Dropdown -->
  <div class="form-group">
    <label for="category">Category *</label>
    <select
      id="category"
      name="category_id"
      [(ngModel)]="productData.category_id"
      required
      class="form-control"
      placeholder="Select a category"
      (change)="onCategoryChange($event)"
      #fCategory="ngModel"
    >
      <option value="" disabled selected class="options">select a category</option>
      <option *ngFor="let category of allCategory" [value]="category.id">
        {{ category.name }}
      </option>
    </select>
    @if (fCategory.touched && fCategory.invalid) {
      <small class="control-error">* Product Category is a Required Field</small>
    }
  </div>

  <!-- Description -->
  <div class="form-group">
    <label for="description">Description *</label>
    <textarea
      id="description"
      name="description"
      [(ngModel)]="productData.description"
      required
      class="form-control"
      placeholder="Enter product description"
      #fdescription="ngModel"
    ></textarea>
    @if (fdescription.touched && fdescription.invalid) {
      <small class="control-error">* Product Description is a Required Field</small>
    }
  </div>

  @if (imageUploadTrue) {
    <div class="form-group">
      <label for="productImage">Product Image</label>
      <div class="image-upload-area">
        <div class="icon-upload">
          <!-- SVG for the upload icon -->
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.92 8.52L19 19.5" />
            <path d="M12 16v6" />
            <path d="M8 20h8" />
          </svg>
        </div>
        <p class="upload-text">Click to upload or drag and drop</p>
        <input
          type="file"
          id="productImage"
          name="productImage"
          ngModel
          class="file-input"
          required
        />
        <button type="button" class="btn-choose-file">Choose File</button>
      </div>
    </div>
  }
  <!-- Duration -->
  <div class="form-group">
    <label for="duration">Duration (in days) *</label>
    <input
      type="number"
      id="duration"
      name="duration"
      [(ngModel)]="productData.duration"
      required
      class="form-control"
      min="1"
      #fduration="ngModel"
    />
    @if (fduration.touched && fduration.invalid) {
      <small class="control-error">* Product Duration is a Required Field</small>
    }
  </div>

  <div class="form-actions">
    <button type="submit" class="btn-submit" [disabled]="productForm.invalid || isLoading">
      Create Product
    </button>
  </div>
</form>
